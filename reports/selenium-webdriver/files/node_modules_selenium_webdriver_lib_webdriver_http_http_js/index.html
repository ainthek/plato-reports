<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/selenium-webdriver/lib/webdriver/http/http.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/es-analysis/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/selenium-webdriver/lib/webdriver/http/http.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">70.41</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">443</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">45.78</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">3.99</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">// Copyright 2011 Software Freedom Conservancy. All Rights Reserved.
//
// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/**
 * @fileoverview Defines a {@code webdriver.CommandExecutor} that communicates
 * with a server over HTTP.
 */

goog.provide(&#039;webdriver.http.Client&#039;);
goog.provide(&#039;webdriver.http.Executor&#039;);
goog.provide(&#039;webdriver.http.Request&#039;);
goog.provide(&#039;webdriver.http.Response&#039;);

goog.require(&#039;bot.ErrorCode&#039;);
goog.require(&#039;goog.array&#039;);
goog.require(&#039;goog.json&#039;);
goog.require(&#039;webdriver.CommandName&#039;);
goog.require(&#039;webdriver.promise.Deferred&#039;);



/**
 * Interface used for sending individual HTTP requests to the server.
 * @interface
 */
webdriver.http.Client = function() {
};


/**
 * Sends a request to the server. If an error occurs while sending the request,
 * such as a failure to connect to the server, the provided callback will be
 * invoked with a non-null {@code Error} describing the error. Otherwise, when
 * the server&#039;s response has been received, the callback will be invoked with a
 * null Error and non-null {@code webdriver.http.Response} object.
 *
 * @param {!webdriver.http.Request} request The request to send.
 * @param {function(Error, !webdriver.http.Response=)} callback the function to
 *     invoke when the server&#039;s response is ready.
 */
webdriver.http.Client.prototype.send = function(request, callback) {
};



/**
 * A command executor that communicates with a server using the WebDriver
 * command protocol.
 * @param {!webdriver.http.Client} client The client to use when sending
 *     requests to the server.
 * @constructor
 * @implements {webdriver.CommandExecutor}
 */
webdriver.http.Executor = function(client) {

  /**
   * Client used to communicate with the server.
   * @private {!webdriver.http.Client}
   */
  this.client_ = client;
};


/** @override */
webdriver.http.Executor.prototype.execute = function(command, callback) {
  var resource = webdriver.http.Executor.COMMAND_MAP_[command.getName()];
  if (!resource) {
    throw new Error(&#039;Unrecognized command: &#039; + command.getName());
  }

  var parameters = command.getParameters();
  var path = webdriver.http.Executor.buildPath_(resource.path, parameters);
  var request = new webdriver.http.Request(resource.method, path, parameters);

  this.client_.send(request, function(e, response) {
    var responseObj;
    if (!e) {
      try {
        responseObj = webdriver.http.Executor.parseHttpResponse_(
            /** @type {!webdriver.http.Response} */ (response));
      } catch (ex) {
        e = ex;
      }
    }
    callback(e, responseObj);
  });
};


/**
 * Builds a fully qualified path using the given set of command parameters. Each
 * path segment prefixed with &#039;:&#039; will be replaced by the value of the
 * corresponding parameter. All parameters spliced into the path will be
 * removed from the parameter map.
 * @param {string} path The original resource path.
 * @param {!Object.&lt;*&gt;} parameters The parameters object to splice into
 *     the path.
 * @return {string} The modified path.
 * @private
 */
webdriver.http.Executor.buildPath_ = function(path, parameters) {
  var pathParameters = path.match(/\/:(\w+)\b/g);
  if (pathParameters) {
    for (var i = 0; i &lt; pathParameters.length; ++i) {
      var key = pathParameters[i].substring(2);  // Trim the /:
      if (key in parameters) {
        var value = parameters[key];
        // TODO: move webdriver.WebElement.ELEMENT definition to a
        // common file so we can reference it here without pulling in all of
        // webdriver.WebElement&#039;s dependencies.
        if (value &amp;&amp; value[&#039;ELEMENT&#039;]) {
          // When inserting a WebElement into the URL, only use its ID value,
          // not the full JSON.
          value = value[&#039;ELEMENT&#039;];
        }
        path = path.replace(pathParameters[i], &#039;/&#039; + value);
        delete parameters[key];
      } else {
        throw new Error(&#039;Missing required parameter: &#039; + key);
      }
    }
  }
  return path;
};


/**
 * Callback used to parse {@link webdriver.http.Response} objects from a
 * {@link webdriver.http.Client}.
 * @param {!webdriver.http.Response} httpResponse The HTTP response to parse.
 * @return {!bot.response.ResponseObject} The parsed response.
 * @private
 */
webdriver.http.Executor.parseHttpResponse_ = function(httpResponse) {
  try {
    return /** @type {!bot.response.ResponseObject} */ (goog.json.parse(
        httpResponse.body));
  } catch (ex) {
    // Whoops, looks like the server sent us a malformed response. We&#039;ll need
    // to manually build a response object based on the response code.
  }

  var response = {
    &#039;status&#039;: bot.ErrorCode.SUCCESS,
    &#039;value&#039;: httpResponse.body.replace(/\r\n/g, &#039;\n&#039;)
  };

  if (!(httpResponse.status &gt; 199 &amp;&amp; httpResponse.status &lt; 300)) {
    // 404 represents an unknown command; anything else is a generic unknown
    // error.
    response[&#039;status&#039;] = httpResponse.status == 404 ?
        bot.ErrorCode.UNKNOWN_COMMAND :
        bot.ErrorCode.UNKNOWN_ERROR;
  }

  return response;
};


/**
 * Maps command names to resource locator.
 * @private {!Object.&lt;{method:string, path:string}&gt;}
 * @const
 */
webdriver.http.Executor.COMMAND_MAP_ = (function() {
  return new Builder().
      put(webdriver.CommandName.GET_SERVER_STATUS, get(&#039;/status&#039;)).
      put(webdriver.CommandName.NEW_SESSION, post(&#039;/session&#039;)).
      put(webdriver.CommandName.GET_SESSIONS, get(&#039;/sessions&#039;)).
      put(webdriver.CommandName.DESCRIBE_SESSION, get(&#039;/session/:sessionId&#039;)).
      put(webdriver.CommandName.QUIT, del(&#039;/session/:sessionId&#039;)).
      put(webdriver.CommandName.CLOSE, del(&#039;/session/:sessionId/window&#039;)).
      put(webdriver.CommandName.GET_CURRENT_WINDOW_HANDLE,
          get(&#039;/session/:sessionId/window_handle&#039;)).
      put(webdriver.CommandName.GET_WINDOW_HANDLES,
          get(&#039;/session/:sessionId/window_handles&#039;)).
      put(webdriver.CommandName.GET_CURRENT_URL,
          get(&#039;/session/:sessionId/url&#039;)).
      put(webdriver.CommandName.GET, post(&#039;/session/:sessionId/url&#039;)).
      put(webdriver.CommandName.GO_BACK, post(&#039;/session/:sessionId/back&#039;)).
      put(webdriver.CommandName.GO_FORWARD,
          post(&#039;/session/:sessionId/forward&#039;)).
      put(webdriver.CommandName.REFRESH,
          post(&#039;/session/:sessionId/refresh&#039;)).
      put(webdriver.CommandName.ADD_COOKIE,
          post(&#039;/session/:sessionId/cookie&#039;)).
      put(webdriver.CommandName.GET_ALL_COOKIES,
          get(&#039;/session/:sessionId/cookie&#039;)).
      put(webdriver.CommandName.DELETE_ALL_COOKIES,
          del(&#039;/session/:sessionId/cookie&#039;)).
      put(webdriver.CommandName.DELETE_COOKIE,
          del(&#039;/session/:sessionId/cookie/:name&#039;)).
      put(webdriver.CommandName.FIND_ELEMENT,
          post(&#039;/session/:sessionId/element&#039;)).
      put(webdriver.CommandName.FIND_ELEMENTS,
          post(&#039;/session/:sessionId/elements&#039;)).
      put(webdriver.CommandName.GET_ACTIVE_ELEMENT,
          post(&#039;/session/:sessionId/element/active&#039;)).
      put(webdriver.CommandName.FIND_CHILD_ELEMENT,
          post(&#039;/session/:sessionId/element/:id/element&#039;)).
      put(webdriver.CommandName.FIND_CHILD_ELEMENTS,
          post(&#039;/session/:sessionId/element/:id/elements&#039;)).
      put(webdriver.CommandName.CLEAR_ELEMENT,
          post(&#039;/session/:sessionId/element/:id/clear&#039;)).
      put(webdriver.CommandName.CLICK_ELEMENT,
          post(&#039;/session/:sessionId/element/:id/click&#039;)).
      put(webdriver.CommandName.SEND_KEYS_TO_ELEMENT,
          post(&#039;/session/:sessionId/element/:id/value&#039;)).
      put(webdriver.CommandName.SUBMIT_ELEMENT,
          post(&#039;/session/:sessionId/element/:id/submit&#039;)).
      put(webdriver.CommandName.GET_ELEMENT_TEXT,
          get(&#039;/session/:sessionId/element/:id/text&#039;)).
      put(webdriver.CommandName.GET_ELEMENT_TAG_NAME,
          get(&#039;/session/:sessionId/element/:id/name&#039;)).
      put(webdriver.CommandName.IS_ELEMENT_SELECTED,
          get(&#039;/session/:sessionId/element/:id/selected&#039;)).
      put(webdriver.CommandName.IS_ELEMENT_ENABLED,
          get(&#039;/session/:sessionId/element/:id/enabled&#039;)).
      put(webdriver.CommandName.IS_ELEMENT_DISPLAYED,
          get(&#039;/session/:sessionId/element/:id/displayed&#039;)).
      put(webdriver.CommandName.GET_ELEMENT_LOCATION,
          get(&#039;/session/:sessionId/element/:id/location&#039;)).
      put(webdriver.CommandName.GET_ELEMENT_SIZE,
          get(&#039;/session/:sessionId/element/:id/size&#039;)).
      put(webdriver.CommandName.GET_ELEMENT_ATTRIBUTE,
          get(&#039;/session/:sessionId/element/:id/attribute/:name&#039;)).
      put(webdriver.CommandName.GET_ELEMENT_VALUE_OF_CSS_PROPERTY,
          get(&#039;/session/:sessionId/element/:id/css/:propertyName&#039;)).
      put(webdriver.CommandName.ELEMENT_EQUALS,
          get(&#039;/session/:sessionId/element/:id/equals/:other&#039;)).
      put(webdriver.CommandName.SWITCH_TO_WINDOW,
          post(&#039;/session/:sessionId/window&#039;)).
      put(webdriver.CommandName.MAXIMIZE_WINDOW,
          post(&#039;/session/:sessionId/window/:windowHandle/maximize&#039;)).
      put(webdriver.CommandName.GET_WINDOW_POSITION,
          get(&#039;/session/:sessionId/window/:windowHandle/position&#039;)).
      put(webdriver.CommandName.SET_WINDOW_POSITION,
          post(&#039;/session/:sessionId/window/:windowHandle/position&#039;)).
      put(webdriver.CommandName.GET_WINDOW_SIZE,
          get(&#039;/session/:sessionId/window/:windowHandle/size&#039;)).
      put(webdriver.CommandName.SET_WINDOW_SIZE,
          post(&#039;/session/:sessionId/window/:windowHandle/size&#039;)).
      put(webdriver.CommandName.SWITCH_TO_FRAME,
          post(&#039;/session/:sessionId/frame&#039;)).
      put(webdriver.CommandName.GET_PAGE_SOURCE,
          get(&#039;/session/:sessionId/source&#039;)).
      put(webdriver.CommandName.GET_TITLE,
          get(&#039;/session/:sessionId/title&#039;)).
      put(webdriver.CommandName.EXECUTE_SCRIPT,
          post(&#039;/session/:sessionId/execute&#039;)).
      put(webdriver.CommandName.EXECUTE_ASYNC_SCRIPT,
          post(&#039;/session/:sessionId/execute_async&#039;)).
      put(webdriver.CommandName.SCREENSHOT,
          get(&#039;/session/:sessionId/screenshot&#039;)).
      put(webdriver.CommandName.SET_TIMEOUT,
          post(&#039;/session/:sessionId/timeouts&#039;)).
      put(webdriver.CommandName.SET_SCRIPT_TIMEOUT,
          post(&#039;/session/:sessionId/timeouts/async_script&#039;)).
      put(webdriver.CommandName.IMPLICITLY_WAIT,
          post(&#039;/session/:sessionId/timeouts/implicit_wait&#039;)).
      put(webdriver.CommandName.MOVE_TO, post(&#039;/session/:sessionId/moveto&#039;)).
      put(webdriver.CommandName.CLICK, post(&#039;/session/:sessionId/click&#039;)).
      put(webdriver.CommandName.DOUBLE_CLICK,
          post(&#039;/session/:sessionId/doubleclick&#039;)).
      put(webdriver.CommandName.MOUSE_DOWN,
          post(&#039;/session/:sessionId/buttondown&#039;)).
      put(webdriver.CommandName.MOUSE_UP, post(&#039;/session/:sessionId/buttonup&#039;)).
      put(webdriver.CommandName.MOVE_TO, post(&#039;/session/:sessionId/moveto&#039;)).
      put(webdriver.CommandName.SEND_KEYS_TO_ACTIVE_ELEMENT,
          post(&#039;/session/:sessionId/keys&#039;)).
      put(webdriver.CommandName.ACCEPT_ALERT,
          post(&#039;/session/:sessionId/accept_alert&#039;)).
      put(webdriver.CommandName.DISMISS_ALERT,
          post(&#039;/session/:sessionId/dismiss_alert&#039;)).
      put(webdriver.CommandName.GET_ALERT_TEXT,
          get(&#039;/session/:sessionId/alert_text&#039;)).
      put(webdriver.CommandName.SET_ALERT_TEXT,
          post(&#039;/session/:sessionId/alert_text&#039;)).
      put(webdriver.CommandName.GET_LOG, post(&#039;/session/:sessionId/log&#039;)).
      put(webdriver.CommandName.GET_AVAILABLE_LOG_TYPES,
          get(&#039;/session/:sessionId/log/types&#039;)).
      put(webdriver.CommandName.GET_SESSION_LOGS, post(&#039;/logs&#039;)).
      build();

  /** @constructor */
  function Builder() {
    var map = {};

    this.put = function(name, resource) {
      map[name] = resource;
      return this;
    };

    this.build = function() {
      return map;
    };
  }

  function post(path) { return resource(&#039;POST&#039;, path); }
  function del(path)  { return resource(&#039;DELETE&#039;, path); }
  function get(path)  { return resource(&#039;GET&#039;, path); }
  function resource(method, path) { return {method: method, path: path}; }
})();


/**
 * Converts a headers object to a HTTP header block string.
 * @param {!Object.&lt;string&gt;} headers The headers object to convert.
 * @return {string} The headers as a string.
 * @private
 */
webdriver.http.headersToString_ = function(headers) {
  var ret = [];
  for (var key in headers) {
    ret.push(key + &#039;: &#039; + headers[key]);
  }
  return ret.join(&#039;\n&#039;);
};



/**
 * Describes a partial HTTP request. This class is a &quot;partial&quot; request and only
 * defines the path on the server to send a request to. It is each
 * {@code webdriver.http.Client}&#039;s responsibility to build the full URL for the
 * final request.
 * @param {string} method The HTTP method to use for the request.
 * @param {string} path Path on the server to send the request to.
 * @param {Object=} opt_data This request&#039;s JSON data.
 * @constructor
 */
webdriver.http.Request = function(method, path, opt_data) {

  /**
   * The HTTP method to use for the request.
   * @type {string}
   */
  this.method = method;

  /**
   * The path on the server to send the request to.
   * @type {string}
   */
  this.path = path;

  /**
   * This request&#039;s body.
   * @type {!Object}
   */
  this.data = opt_data || {};

  /**
   * The headers to send with the request.
   * @type {!Object.&lt;(string|number)&gt;}
   */
  this.headers = {&#039;Accept&#039;: &#039;application/json; charset=utf-8&#039;};
};


/** @override */
webdriver.http.Request.prototype.toString = function() {
  return [
    this.method + &#039; &#039; + this.path + &#039; HTTP/1.1&#039;,
    webdriver.http.headersToString_(this.headers),
    &#039;&#039;,
    goog.json.serialize(this.data)
  ].join(&#039;\n&#039;);
};



/**
 * Represents a HTTP response.
 * @param {number} status The response code.
 * @param {!Object.&lt;string&gt;} headers The response headers. All header
 *     names will be converted to lowercase strings for consistent lookups.
 * @param {string} body The response body.
 * @constructor
 */
webdriver.http.Response = function(status, headers, body) {

  /**
   * The HTTP response code.
   * @type {number}
   */
  this.status = status;

  /**
   * The response body.
   * @type {string}
   */
  this.body = body;

  /**
   * The response body.
   * @type {!Object.&lt;string&gt;}
   */
  this.headers = {};
  for (var header in headers) {
    this.headers[header.toLowerCase()] = headers[header];
  }
};


/**
 * Builds a {@code webdriver.http.Response} from a {@code XMLHttpRequest} or
 * {@code XDomainRequest} response object.
 * @param {!(XDomainRequest|XMLHttpRequest)} xhr The request to parse.
 * @return {!webdriver.http.Response} The parsed response.
 */
webdriver.http.Response.fromXmlHttpRequest = function(xhr) {
  var headers = {};

  // getAllResponseHeaders is only available on XMLHttpRequest objects.
  if (xhr.getAllResponseHeaders) {
    var tmp = xhr.getAllResponseHeaders();
    if (tmp) {
      tmp = tmp.replace(/\r\n/g, &#039;\n&#039;).split(&#039;\n&#039;);
      goog.array.forEach(tmp, function(header) {
        var parts = header.split(/\s*:\s*/, 2);
        if (parts[0]) {
          headers[parts[0]] = parts[1] || &#039;&#039;;
        }
      });
    }
  }

  // If xhr is a XDomainRequest object, it will not have a status.
  // However, if we&#039;re parsing the response from a XDomainRequest, then
  // that request must have been a success, so we can assume status == 200.
  var status = xhr.status || 200;
  return new webdriver.http.Response(status, headers,
      xhr.responseText.replace(/\0/g, &#039;&#039;));
};


/** @override */
webdriver.http.Response.prototype.toString = function() {
  var headers = webdriver.http.headersToString_(this.headers);
  var ret = [&#039;HTTP/1.1 &#039; + this.status, headers];

  if (headers) {
    ret.push(&#039;&#039;);
  }

  if (this.body) {
    ret.push(this.body);
  }

  return ret.join(&#039;\n&#039;);
};</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
